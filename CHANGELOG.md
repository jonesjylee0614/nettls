# 更新日志

所有重要的更改都将记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [1.0.3] - 2025-11-12

### 新增 (重大功能)
- ✨ **系统路由直接新增功能** - 一键添加永久路由到系统
- ✨ 简化的新增路由对话框 - 只需3个字段 (目标、网关、Metric)
- ✨ 智能默认值 - 网关默认 192.168.1.1, Metric默认 1
- ✨ 网关筛选功能 - 按网关分组查看路由
- ✨ 默认显示系统路由标签页 - 更符合用户使用习惯

### 优化
- ⚡ 改进网关筛选逻辑 - 使用 itemData 存储实际网关地址
- 🎨 增强系统路由工具栏 - 添加绿色"新增路由"按钮
- 🎨 优化按钮样式 - 绿色新增,红色删除,清晰直观
- 📊 智能网关排序 - 192开头的网关优先显示

### 技术改进
- 🔧 实现 `_on_add_system_route()` - 新增系统路由功能
- 🔧 优化 `_update_system_routes_table()` - 改进筛选逻辑
- 🔧 改进 `_on_gateway_filter_changed()` - 简化事件处理
- 🔧 默认标签页设置 - setCurrentIndex(1)

### 用户体验
- 🎯 一键添加路由 - 输入目标IP即可,网关自动填充
- 🎯 直接应用到系统 - 无需二次操作
- 🎯 友好的默认值 - 符合常用配置
- 🎯 清晰的操作反馈 - 成功/失败提示完善

## [1.0.2] - 2025-11-12

### 新增
- ✨ 添加启动加载进度对话框 - 三步加载提示,实时显示进度
- ✨ 首页路由统计信息面板 - 显示总路由、已启用、已应用、系统路由数量
- ✨ 路由统计实时更新 - F5 刷新或切换标签页时自动更新

### 优化
- ⚡ 改进加载体验 - 进度对话框提供清晰的加载状态反馈
- 🎨 增强信息可见性 - 左侧统计面板一目了然

### 验证
- ✅ 确认系统路由功能正常 - PowerShell Get-NetRoute 正确获取所有路由
- ✅ 验证永久路由显示 - 18条永久路由 (Protocol: NetMgmt) 正确识别

### 技术改进
- 🔧 新增 `_update_route_stats()` 统计信息更新方法
- 🔧 改进 `_delayed_refresh()` 添加进度对话框
- 🔧 路由统计面板使用 QGroupBox + QGridLayout
- 🔧 在刷新和加载时自动更新统计

## [1.0.1] - 2025-11-12

### 修复
- 🐛 修复 `route_dialog.py` 缺少 `Tuple` 类型导入导致的启动错误

### 优化
- ⚡ 优化启动速度 - 使用延迟加载机制,窗口立即显示
- 🎨 重构主窗口为标签页架构,提升用户体验

### 新增
- ✨ 添加"系统路由"标签页 - 显示系统中所有实际存在的路由
- ✨ 配置路由表格新增"系统状态"列 - 实时显示路由是否已生效
- ✨ 路由状态可视化 - 绿色标记已生效,灰色标记未应用
- ✨ 自动刷新机制 - 切换标签页时自动更新系统路由

### 变更
- 🗑️ 删除多余的 `example.json` - 只保留 `home.json` 作为默认 profile
- 📊 配置路由表格列数从 11 列增加到 12 列(新增系统状态列)

### 技术改进
- 🔧 实现 `_delayed_refresh()` 异步加载机制
- 🔧 新增 `_check_route_in_system()` 智能路由状态检查
- 🔧 添加系统路由表格独立管理
- 🔧 优化标签页切换性能

## [1.0.0] - 2025-11-11

### 新增
- ✨ 完整的路由管理功能(新增、编辑、删除、应用)
- ✨ 支持 IPv4、CIDR、域名(自动解析)
- ✨ Diff 预览与一键应用
- ✨ 路由验证功能(route print + TraceRoute)
- ✨ 快照与回滚机制
- ✨ Profile 多配置管理
- ✨ 批量导入导出(JSON/CSV)
- ✨ 分组管理
- ✨ WireGuard 全隧道检测
- ✨ 完整的表单校验
- ✨ 审计日志
- ✨ 管理员权限检测
- ✨ PyInstaller 打包配置

### 技术特性
- 🔒 Apply 前自动创建快照
- 🔒 执行失败自动回滚(LIFO)
- 🔒 幂等执行(跳过已存在且一致的路由)
- 🔧 接口名动态解析(避免 ifIndex 漂移)
- 🔧 完整的错误处理和日志记录
- 🎨 基于 PyQt6 的现代化界面
- 📝 完整的文档和示例

### 文档
- 📚 用户指南
- 📚 设计文档
- 📚 原型说明
- 📚 README 文档
- 📚 示例配置文件

---

## 计划中的功能

### [1.1.0] - 计划中
- [ ] IPv6 支持
- [ ] 设置面板(高级选项配置)
- [ ] 路由导出为批处理脚本
- [ ] 定时任务(定时应用/验证)
- [ ] 更多导入导出格式

### [1.2.0] - 计划中
- [ ] 图表统计(路由分布、接口使用情况)
- [ ] 远程配置同步
- [ ] 多语言支持
- [ ] 自动更新检查

### [2.0.0] - 未来愿景
- [ ] 跨平台支持(Linux, macOS)
- [ ] Web 管理界面
- [ ] API 接口
- [ ] 插件系统

---

[1.0.0]: https://github.com/yourusername/nettls/releases/tag/v1.0.0

