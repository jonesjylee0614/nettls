# RouteManager æ‰“åŒ…è¯´æ˜

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### æ‰“åŒ…ç¨‹åº

ç›´æ¥åŒå‡»è¿è¡Œæ‰“åŒ…è„šæœ¬ï¼š

```bash
package_conda.bat
```

æˆ–åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œï¼š

```bash
# ä½¿ç”¨é»˜è®¤ç¯å¢ƒ py311
package_conda.bat

# æˆ–æŒ‡å®šå…¶ä»– Conda ç¯å¢ƒ
package_conda.bat base
package_conda.bat myenv
```

### æ‰“åŒ…æµç¨‹

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

1. âœ… æ¿€æ´» Conda ç¯å¢ƒï¼ˆé»˜è®¤ py311ï¼‰
2. âœ… å®‰è£…å¿…è¦çš„ä¾èµ–ï¼ˆPyQt6, PyInstallerï¼‰
3. âœ… æ¸…ç†æ—§çš„æ„å»ºæ–‡ä»¶
4. âœ… ä½¿ç”¨ PyInstaller æ‰“åŒ…ç¨‹åº
5. âœ… åˆ›å»ºå®Œæ•´çš„åº”ç”¨ç›®å½•ç»“æ„
6. âœ… å¤åˆ¶æ–‡æ¡£å’Œé…ç½®æ–‡ä»¶
7. âœ… åˆ›å»ºå‹ç¼©åŒ…ï¼ˆå¯é€‰ï¼‰

### æ‰“åŒ…ç»“æœ

æ‰“åŒ…å®Œæˆåï¼Œä¼šç”Ÿæˆï¼š

```
dist/
  â”œâ”€â”€ RouteManager-Portable/              # å®Œæ•´åº”ç”¨åŒ…
  â”‚   â”œâ”€â”€ RouteManager.exe                # ä¸»ç¨‹åºï¼ˆéœ€ç®¡ç†å‘˜æƒé™ï¼‰
  â”‚   â”œâ”€â”€ ä½¿ç”¨è¯´æ˜.txt                   # å¿«é€Ÿä½¿ç”¨æŒ‡å—
  â”‚   â”œâ”€â”€ README.md                       # é¡¹ç›®è¯´æ˜
  â”‚   â”œâ”€â”€ LICENSE                         # è®¸å¯è¯
  â”‚   â”œâ”€â”€ CHANGELOG.md                    # æ›´æ–°æ—¥å¿—
  â”‚   â”œâ”€â”€ profiles/                       # é…ç½®æ–‡ä»¶ç›®å½•
  â”‚   â”‚   â””â”€â”€ home.example.json           # ç¤ºä¾‹é…ç½®
  â”‚   â”œâ”€â”€ snapshots/                      # å¿«ç…§æ–‡ä»¶ç›®å½•
  â”‚   â”œâ”€â”€ logs/                           # æ—¥å¿—æ–‡ä»¶ç›®å½•
  â”‚   â””â”€â”€ docs/                           # æ–‡æ¡£ç›®å½•
  â”‚       â”œâ”€â”€ USER_GUIDE.md               # ç”¨æˆ·æ‰‹å†Œ
  â”‚       â””â”€â”€ è·¯ç”±æ©ç ä½¿ç”¨è¯´æ˜.md         # è·¯ç”±æ©ç è¯´æ˜
  â””â”€â”€ RouteManager-Portable-YYYYMMDD.zip  # å‹ç¼©åŒ…
```

## ğŸš€ ä½¿ç”¨æ‰“åŒ…åçš„ç¨‹åº

### æ–¹å¼ 1ï¼šæœ¬åœ°æµ‹è¯•

```bash
cd dist\RouteManager-Portable
.\RouteManager.exe
```

### æ–¹å¼ 2ï¼šå¤åˆ¶åˆ°å…¶ä»–ä½ç½®

å°†æ•´ä¸ª `RouteManager-Portable` æ–‡ä»¶å¤¹å¤åˆ¶åˆ°ä»»ä½•ä½ç½®ä½¿ç”¨ï¼š

```bash
# å¤åˆ¶åˆ° D ç›˜
xcopy dist\RouteManager-Portable D:\RouteManager\ /E /I /H /Y

# æˆ–ä½¿ç”¨æ–‡ä»¶ç®¡ç†å™¨ç›´æ¥å¤åˆ¶ç²˜è´´
```

### æ–¹å¼ 3ï¼šåˆ†å‘å‹ç¼©åŒ…

ä½¿ç”¨ç”Ÿæˆçš„ ZIP å‹ç¼©åŒ…ï¼š
1. å°† `RouteManager-Portable-YYYYMMDD.zip` å‘é€ç»™å…¶ä»–ç”¨æˆ·
2. åœ¨ç›®æ ‡æœºå™¨ä¸Šè§£å‹åˆ°ä»»æ„ç›®å½•
3. åŒå‡» `RouteManager.exe` è¿è¡Œ

## âš™ï¸ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹ Conda ç¯å¢ƒ

ç¼–è¾‘ `package_conda.bat` æ–‡ä»¶ï¼Œæ‰¾åˆ°è¿™ä¸€è¡Œï¼š

```batch
set "CONDA_ENV=py311"
```

æ”¹ä¸ºæ‚¨æƒ³ä½¿ç”¨çš„ç¯å¢ƒåç§°ï¼š

```batch
set "CONDA_ENV=base"
# æˆ–
set "CONDA_ENV=your_env_name"
```

### ä¿®æ”¹ PyInstaller é…ç½®

ç¼–è¾‘ `RouteManager.spec` æ–‡ä»¶å¯ä»¥è‡ªå®šä¹‰æ‰“åŒ…é€‰é¡¹ï¼š

#### æ·»åŠ ç¨‹åºå›¾æ ‡

```python
exe = EXE(
    ...
    icon='app.ico',  # æŒ‡å®šå›¾æ ‡æ–‡ä»¶è·¯å¾„
    ...
)
```

#### åŒ…å«é¢å¤–èµ„æºæ–‡ä»¶

```python
a = Analysis(
    ...
    datas=[
        ('assets/*.png', 'assets'),
        ('config/*.ini', 'config'),
    ],
    ...
)
```

#### æ’é™¤ä¸éœ€è¦çš„æ¨¡å—

```python
a = Analysis(
    ...
    excludes=['tkinter', 'matplotlib', 'numpy', ...],
    ...
)
```

#### æ·»åŠ éšè—å¯¼å…¥

```python
a = Analysis(
    ...
    hiddenimports=['PyQt6.sip', 'PyQt6.QtCore', ...],
    ...
)
```

## ğŸ”§ ç¯å¢ƒå‡†å¤‡

### å¿…éœ€è½¯ä»¶

1. **Python 3.8+**
2. **Conda** ç¯å¢ƒç®¡ç†å™¨
3. **PyQt6** å’Œ **PyInstaller**ï¼ˆè„šæœ¬ä¼šè‡ªåŠ¨å®‰è£…ï¼‰

### é¦–æ¬¡æ‰“åŒ…

å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æ‰“åŒ…ï¼Œç¡®ä¿ï¼š

```bash
# 1. æ¿€æ´» Conda ç¯å¢ƒ
conda activate py311

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 3. è¿è¡Œæ‰“åŒ…è„šæœ¬
package_conda.bat
```

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šæ¿€æ´» Conda ç¯å¢ƒå¤±è´¥

**é”™è¯¯ä¿¡æ¯ï¼š**
```
âœ— æ¿€æ´»å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç¯å¢ƒåç§°æ˜¯å¦æ­£ç¡®
```

**è§£å†³æ–¹æ³•ï¼š**

1. æŸ¥çœ‹å¯ç”¨çš„ Conda ç¯å¢ƒï¼š
   ```bash
   conda env list
   ```

2. ä¿®æ”¹è„šæœ¬ä¸­çš„ç¯å¢ƒåç§°æˆ–ä½¿ç”¨å‚æ•°æŒ‡å®šï¼š
   ```bash
   package_conda.bat your_env_name
   ```

### é—®é¢˜ 2ï¼šæ‰¾ä¸åˆ° pyinstaller å‘½ä»¤

**é”™è¯¯ä¿¡æ¯ï¼š**
```
'pyinstaller' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤
```

**è§£å†³æ–¹æ³•ï¼š**

```bash
# æ¿€æ´»ç¯å¢ƒ
conda activate py311

# å®‰è£… PyInstaller
pip install pyinstaller

# é‡æ–°è¿è¡Œæ‰“åŒ…è„šæœ¬
package_conda.bat
```

### é—®é¢˜ 3ï¼šæ‰“åŒ…å¤±è´¥

**å¯èƒ½åŸå› ï¼š**
- PyQt6 ç‰ˆæœ¬ä¸å…¼å®¹
- ç¼ºå°‘æŸäº›ä¾èµ–
- æ–‡ä»¶è¢«å ç”¨

**è§£å†³æ–¹æ³•ï¼š**

```bash
# 1. æ¸…ç†æ‰€æœ‰ç¼“å­˜
rmdir /s /q build dist
for /d /r . %d in (__pycache__) do @if exist "%d" rmdir /s /q "%d"

# 2. é‡æ–°å®‰è£…ä¾èµ–
pip uninstall pyqt6 pyinstaller -y
pip install pyqt6==6.6.1 pyinstaller==6.3.0

# 3. ç¡®ä¿æ²¡æœ‰ç¨‹åºåœ¨è¿è¡Œ

# 4. é‡æ–°æ‰“åŒ…
package_conda.bat
```

### é—®é¢˜ 4ï¼šexe æ–‡ä»¶å¾ˆå¤§

**è¯´æ˜ï¼š** è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œå•æ–‡ä»¶æ‰“åŒ…ä¼šåŒ…å«ï¼š
- Python è§£é‡Šå™¨ï¼ˆ~15MBï¼‰
- PyQt6 åº“ï¼ˆ~80-100MBï¼‰
- æ‰€æœ‰ä¾èµ–é¡¹

**å¤§å°å‚è€ƒï¼š** é€šå¸¸åœ¨ 100-150MB å·¦å³

**ä¼˜åŒ–æ–¹æ³•ï¼š**
- å·²ä½¿ç”¨ UPX å‹ç¼©ï¼ˆåœ¨ spec æ–‡ä»¶ä¸­ï¼‰
- å¯ä»¥æ’é™¤ä¸éœ€è¦çš„æ¨¡å—ï¼ˆè§è‡ªå®šä¹‰é…ç½®ï¼‰

### é—®é¢˜ 5ï¼šæ€æ¯’è½¯ä»¶æŠ¥è­¦

**åŸå› ï¼š** PyInstaller æ‰“åŒ…çš„ç¨‹åºå¯èƒ½è¢«è¯¯æŠ¥ä¸ºå¨èƒ

**è§£å†³æ–¹æ³•ï¼š**
1. æ·»åŠ åˆ°æ€æ¯’è½¯ä»¶ç™½åå•
2. ä½¿ç”¨ä»£ç ç­¾åè¯ä¹¦ç­¾åï¼ˆéœ€è¦è´­ä¹°ï¼‰
3. å‘æ€æ¯’è½¯ä»¶å‚å•†æŠ¥å‘Šè¯¯æŠ¥

### é—®é¢˜ 6ï¼šç¨‹åºæ— æ³•å¯åŠ¨

**å¯èƒ½åŸå› ï¼š**
- ç¼ºå°‘ç®¡ç†å‘˜æƒé™
- è¢«å®‰å…¨è½¯ä»¶é˜»æ­¢
- æ–‡ä»¶æŸå

**è§£å†³æ–¹æ³•ï¼š**
1. å³é”®ç‚¹å‡» `RouteManager.exe` â†’ "ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ"
2. æ£€æŸ¥æ€æ¯’è½¯ä»¶æ—¥å¿—
3. é‡æ–°æ‰“åŒ…

## ğŸ“Š æ‰“åŒ…å‚æ•°è¯´æ˜

### PyInstaller ä¸»è¦å‚æ•°

å½“å‰ `RouteManager.spec` ä½¿ç”¨çš„å‚æ•°ï¼š

| å‚æ•° | å€¼ | è¯´æ˜ |
|------|-----|------|
| `--onefile` | - | æ‰“åŒ…æˆå•ä¸ª exe æ–‡ä»¶ |
| `--windowed` | - | GUI æ¨¡å¼ï¼Œä¸æ˜¾ç¤ºæ§åˆ¶å° |
| `--name` | RouteManager | è¾“å‡ºæ–‡ä»¶å |
| `--uac-admin` | - | è¯·æ±‚ç®¡ç†å‘˜æƒé™ |
| `--clean` | - | æ¸…ç†ä¸´æ—¶æ–‡ä»¶ |
| `--noconfirm` | - | ä¸è¯¢é—®ç¡®è®¤ |
| `upx` | True | ä½¿ç”¨ UPX å‹ç¼© |

## ğŸ”„ ç‰ˆæœ¬å‘å¸ƒæµç¨‹

### 1. å‡†å¤‡å‘å¸ƒ

```bash
# æ›´æ–°ç‰ˆæœ¬å·å’Œæ–‡æ¡£
# ç¼–è¾‘ CHANGELOG.md æ·»åŠ æ›´æ–°è¯´æ˜

# æäº¤ä»£ç 
git add .
git commit -m "Release v1.0.0"
git tag v1.0.0
git push origin main --tags
```

### 2. æ‰“åŒ…å‘å¸ƒ

```bash
# è¿è¡Œæ‰“åŒ…è„šæœ¬
package_conda.bat

# éªŒè¯æ‰“åŒ…ç»“æœ
test_package.bat

# æµ‹è¯•ç¨‹åºåŠŸèƒ½
cd dist\RouteManager-Portable
.\RouteManager.exe
```

### 3. åˆ†å‘ç¨‹åº

- **GitHub Releases**: ä¸Šä¼  ZIP å‹ç¼©åŒ…
- **ç½‘ç›˜åˆ†äº«**: ç™¾åº¦ç½‘ç›˜ã€é˜¿é‡Œäº‘ç›˜ç­‰
- **å†…éƒ¨åˆ†å‘**: ç›´æ¥å¤åˆ¶æ–‡ä»¶å¤¹

## ğŸ’¡ æœ€ä½³å®è·µ

### å¼€å‘é˜¶æ®µ

- é¢‘ç¹ä¿®æ”¹ä»£ç æ—¶ï¼Œä½¿ç”¨å¿«é€Ÿæ‰“åŒ…æµ‹è¯•
- ä¿æŒ Conda ç¯å¢ƒä¾èµ–æœ€æ–°

### æµ‹è¯•é˜¶æ®µ

- åœ¨å¹²å‡€çš„è™šæ‹Ÿæœºä¸Šæµ‹è¯•æ‰“åŒ…ç»“æœ
- æµ‹è¯•ä¸åŒ Windows ç‰ˆæœ¬çš„å…¼å®¹æ€§
- éªŒè¯ç®¡ç†å‘˜æƒé™æç¤ºæ˜¯å¦æ­£å¸¸

### å‘å¸ƒé˜¶æ®µ

- ä½¿ç”¨å®Œæ•´æ‰“åŒ…æµç¨‹
- è¯¦ç»†æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
- å‡†å¤‡å®Œæ•´çš„æ–‡æ¡£å’Œæ›´æ–°æ—¥å¿—

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `README.md` - é¡¹ç›®è¯´æ˜
- `docs/USER_GUIDE.md` - ç”¨æˆ·ä½¿ç”¨æ‰‹å†Œ
- `docs/è·¯ç”±æ©ç ä½¿ç”¨è¯´æ˜.md` - è·¯ç”±æ©ç è¯¦ç»†è¯´æ˜
- `CHANGELOG.md` - ç‰ˆæœ¬æ›´æ–°å†å²

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼š
1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶: `logs/rtmgr.log`
2. æŸ¥çœ‹ç”¨æˆ·æ‰‹å†Œ: `docs/USER_GUIDE.md`
3. æäº¤ Issue åˆ°é¡¹ç›®ä»“åº“

---

**æœ€åæ›´æ–°**: 2025-11-12  
**é€‚ç”¨ç‰ˆæœ¬**: RouteManager v2.0+  
**æ‰“åŒ…è„šæœ¬**: package_conda.bat
